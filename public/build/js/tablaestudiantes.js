!function(){let o,e,t;async function n(){$.ajax({url:"/api/estudiantes/all",dataType:"json",success:function(o){console.log(o);$("#tablaEstudiantes").DataTable({destroy:!0,data:o,columns:[{data:"Id"},{data:"Nombres"},{data:"Cod_estudiante"},{data:"usser"},{data:"Tutor_Nombres"},{data:null,render:function(o,e,t){return`\n                                <button type="button" class="btn btn-primary btn-editar" data-bs-toggle="modal" data-bs-target="#editarModal" data-id="${t.id}">Editar</button>\n                                <button type="button" class="btn btn-danger btn-borrar" data-id="${t.Id}" data-tut="${t.Id_tutor}">Borrar</button>\n                                           `}}],language:{lengthMenu:"Mostrar _MENU_ registros por página",zeroRecords:"No se encontraron resultados",info:"Mostrando página _PAGE_ de _PAGES_",infoEmpty:"No hay registros disponibles",infoFiltered:"(filtrado de _MAX_ registros totales)",search:"Buscar:",loadingRecords:"Cargando...",processing:"Procesando...",emptyTable:"No hay datos disponibles en la tabla",aria:{sortAscending:": activar para ordenar la columna de manera ascendente",sortDescending:": activar para ordenar la columna de manera descendente"}}})},error:function(o,e,t){console.error(o.responseText)}})}$.ajax({url:"/api/estudiantes/all",dataType:"json",success:function(o){console.log(o);$("#tablaEstudiantes").DataTable({data:o,columns:[{data:"Id"},{data:"Nombres"},{data:"Cod_estudiante"},{data:"usser"},{data:"Tutor_Nombres"},{data:null,render:function(o,e,t){return`\n                            <button type="button" class="btn btn-primary btn-editar" data-bs-toggle="modal" data-bs-target="#editarModal" data-id="${t.id}">Editar</button>\n                            <button type="button" class="btn btn-danger btn-borrar" data-id="${t.Id}" data-tut="${t.Id_tutor}">Borrar</button>\n                                       `}}],language:{lengthMenu:"Mostrar _MENU_ registros por página",zeroRecords:"No se encontraron resultados",info:"Mostrando página _PAGE_ de _PAGES_",infoEmpty:"No hay registros disponibles",infoFiltered:"(filtrado de _MAX_ registros totales)",search:"Buscar:",loadingRecords:"Cargando...",processing:"Procesando...",emptyTable:"No hay datos disponibles en la tabla",aria:{sortAscending:": activar para ordenar la columna de manera ascendente",sortDescending:": activar para ordenar la columna de manera descendente"}}})},error:function(o,e,t){console.error(o.responseText)}}),$.ajax({url:"/api/sexo/all",dataType:"json",success:function(e){o=e,console.log(e,"del sexo"),$("#sexo").empty(),e.forEach((function(o){$("#sexo").append('<option value="'+o.Id+'">'+o.Nombre+"</option>")}))},error:function(o){}}),$.ajax({url:"/api/departamentos/all",dataType:"json",success:function(o){console.log(o,"del departamento"),$("#Departamento").empty(),o.forEach((function(o){$("#Departamento").append('<option value="'+o.IdDepartamento+'">'+o.Nombre+"</option>")}))},error:function(o){}}),$.ajax({url:"/api/municipios/all",dataType:"json",success:function(o){console.log(o,"del municipios"),$("#Municipio").empty(),o.forEach((function(o){$("#Municipio").append('<option value="'+o.IdMunicipio+'">'+o.Nombre+"</option>")}))},error:function(o){}}),$.ajax({url:"/api/tutores/all",dataType:"json",success:function(o){console.log(o,"de los tutores"),t=o},error:function(o,e,t){console.error(o.responseText)}}),$("#tablaEstudiantes").on("click",".btn-borrar",(function(){const o=$(this).data("id"),e=$(this).data("tut");console.log("eliminar el registro ID:",o),console.log("eliminar el registro IDTutor:",e),$.ajax({url:"/api/estudiantes/dell",type:"POST",data:{Id:o,Id_Tutor:e},dataType:"json",success:async function(o){console.log(o);if(o.exito)return await n(),void await Swal.fire({icon:"success",html:'<span style="font-size: 1.5rem; font-weight: 900;">Eliminado Correctamente</span>',toast:!0,position:"bottom-end",iconColor:"green",timer:1500,padding:"2rem",background:"#B8FFB8",showConfirmButton:!1})},error:function(o,e,t){console.error("Error:",t)}})})),$(document).ready((()=>{$('input[name="tutorExistente"]').change((function(){const n=$(this).val();$("#tutorchange").empty(),"2"===n?(e=2,console.log("Tutor existente seleccionado"),$("#tutorchange").append(" <form id='formTutorNuevo'>\n                <div class='mb-3'>\n                        <label for='nombresUsser' class='form-label'>Nombres</label>\n                        <input type='text' class='form-control' name='Nombres' id='nombresUsser'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='apellidosUsser' class='form-label'>Apellidos</label>\n                        <input type='text' class='form-control' name='Apellidos' id='apellidosUsser'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='Telefono' class='form-label'>Telefono</label>\n                        <input type='number' min=\"8\" max=\"9\" class='form-control' name='Telefono' id='Telefono'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='Cedula' class='form-label'>Cédula</label>\n                        <input type='text' class='form-control' name='Cedula' id='Cedula'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='Ocupacion' class='form-label'>Ocupación</label>\n                        <input type='text' class='form-control' name='Ocupacion' id='Ocupacion'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='Direccion' class='form-label'>Dirección</label>\n                        <textarea name='Direccion' id='Direccion' class='form-control'></textarea>\n                    </div>\n\n                    <div class='mb-3'>\n                        <label for='sexoTutor' class='form-label'>Sexo</label>\n                        <select class='form-select' name='Id_sexo' id='sexoTutor'>\n                        </select>\n                    </div>\n                </form>"),o.forEach((function(o){$("#sexoTutor").append('<option value="'+o.Id+'">'+o.Nombre+"</option>")}))):"1"===n&&(e=1,console.log("Nuevo tutor seleccionado"),$("#tutorchange").append("<form id='formTutorExistente'>\n\n                <div class='mb-3'>\n                        <label for='Tutor' class='form-label'>Tutor</label>\n                        <select class='form-select' name='Id_Tutor' id='Tutor'>\n                        </select>\n                    </div>\n\n\n                </form>"),t.forEach((function(o){$("#Tutor").append('<option value="'+o.Id+'">'+o.Nombres+" "+o.Apellidos+"</option>")})))})),$(document).ready((()=>{$("#GuardarEstudiante").click((async()=>{const o=new FormData($("#formAddDatosPersonales")[0]),e=new FormData($("#formEstudiante")[0]);function t(o){let e={};return o.forEach(((o,t)=>{e[t]=o})),e}const a=t(o),r=t(e),s={datos_personales:a,estudiante:r},i=/^\d{8,11}$/,l=/^\d{13}[A-Za-z]$/,d=$('input[name="Telefono"]'),c=$('input[name="Cedula"]');let u=!0;if(d.each((async function(){if(!i.test($(this).val()))return u=!1,await Swal.fire({icon:"error",html:'<span style="font-size: 1.5rem; font-weight: 800;">El celular debe tener de 8 a 12 dígitos</span>',toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"rgb(255, 184, 184)",showConfirmButton:!1}),$(this).css("border","1px solid red"),!1;$(this).css("border","")})),c.each((async function(){if(!l.test($(this).val()))return u=!1,await Swal.fire({icon:"error",html:'<span style="font-size: 1.5rem; font-weight: 800;">La cédula está mal formateada</span>',toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"rgb(255, 184, 184)",showConfirmButton:!1}),$(this).css("border","1px solid red"),!1;$(this).css("border","")})),!u)return;const m=$("input[name='tutorExistente']:checked").val();if(m)if(m){if(1==m){const o=t(new FormData($("#formTutorExistente")[0]));s.TutorExistente=o,delete s.TutorNuevo}else{const o=t(new FormData($("#formTutorNuevo")[0]));s.TutorNuevo=o,delete s.TutorExistente}p(a)&&p(r)&&(1!=m||p(s.TutorExistente))&&(1==m||p(s.TutorNuevo))?($.ajax({url:"/api/estudiantes/add",dataType:"json",type:"POST",data:s,success:async function(o){if(console.log(o,"del back"),!o.alert)return o.exito?(await n(),$("#formAddDatosPersonales")[0].reset(),$("#formEstudiante")[0].reset(),1!=m&&$("#formTutorNuevo")[0].reset(),$("#tutorchange").empty(),$('input[name="tutorExistente"]').prop("checked",!1),$("#agregarModal").modal("hide"),void await Swal.fire({icon:"success",html:`<span style="font-size: 1.5rem; font-weight: 900;">${o.exito}</span>`,toast:!0,position:"bottom-end",iconColor:"green",timer:1500,padding:"2rem",background:"#B8FFB8",showConfirmButton:!1})):void(o.error&&await Swal.fire({icon:"error",html:`<span style="font-size: 1.5rem; font-weight: 900;">${o.error}</span>`,toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"#FFB8B8",showConfirmButton:!1}));await Swal.fire({icon:"warning",html:`<span style="font-size: 1.5rem; font-weight: 900;">${o.alert}</span>`,toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"#FFFFB8",showConfirmButton:!1})},error:function(o){}}),console.log(s)):await Swal.fire({icon:"error",html:'<span style="font-size: 1.5rem; font-weight: 900;">Todos los campos son obligatorios</span>',toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"rgb(255, 199, 199)",showConfirmButton:!1})}else await Swal.fire({icon:"error",html:'<span style="font-size: 1.5rem; font-weight: 800;">Debe seleccionar una opción para el tutor</span>',toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"rgb(255, 184, 184)",showConfirmButton:!1});else await Swal.fire({icon:"error",html:'<span style="font-size: 1.5rem; font-weight: 800;">Debe seleccionar una opción para el tutor</span>',toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"rgb(255, 184, 184)",showConfirmButton:!1});function p(o){for(let e in o)if(""===o[e].trim())return!1;return!0}}))}))}))}();//# sourceMappingURL=tablaestudiantes.js.map
