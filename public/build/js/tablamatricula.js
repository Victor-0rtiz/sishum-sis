!function(){let e,o,t,n,a,r=[],i=[];function s(e){let o={};return e.forEach(((e,t)=>{o[t]=e})),o}async function l(){$.ajax({url:"/api/matricula/all",dataType:"json",success:async function(e){console.log(e);const o=$("#tablaMatriculas").DataTable();o.clear(),o.rows.add(e),o.draw()},error:function(e,o,t){console.error(e.responseText)}})}$(document).ready((()=>{$('input[name="EstudianteExistente"]').change((function(){const o=$(this).val();$("#Estudiantechange").empty(),"2"===o?(e=2,$("#Estudiantechange").append('  <div>\n                        <h3 class="fs-2">Información y Datos Personales del Estudiante</h3>\n                    </div>\n\n\n\n                    <form id="formAddDatosPersonalesEstudiante">\n                        <div class="mb-3">\n                            <label for="nombresUsser" class="form-label">Nombres</label>\n                            <input type="text" class="form-control" name="Nombres" id="nombresUsser">\n                        </div>\n                        <div class="mb-3">\n                            <label for="apellidosUsser" class="form-label">Apellidos</label>\n                            <input type="text" class="form-control" name="Apellidos" id="apellidosUsser">\n                        </div>\n                        <div class="mb-3">\n                            <label for="Telefono" class="form-label">Telefono</label>\n                            <input type="number" class="form-control" name="Telefono" id="Telefono">\n                        </div> \n                        <div class="mb-3">\n                            <label for="Direccion" class="form-label">Dirección</label>\n                            <textarea name="Direccion" id="Direccion" class="form-control"></textarea>\n                        </div>\n\n                        <div class="mb-3">\n                            <label for="sexo" class="form-label">Sexo</label>\n                            <select class="form-select" name="Id_sexo" id="sexo">\n                            </select>\n                        </div>\n\n\n                    </form>\n\n                    <div class="mt-5">\n                        <h3 class="fs-2">Código del Estudiante y Ubicación </h3>\n                    </div>\n\n                    <form id="formEstudiante">\n                        <div class="mb-3">\n                            <label for="Cod_estudiante" class="form-label">Código de Estudiante</label>\n                            <input name="Cod_estudiante" id="Cod_estudiante" class="form-control">\n                        </div>\n                        <div class="mb-3">\n                            <label for="Departamento" class="form-label">Departamento</label>\n                            <select class="form-select" name="IdDepartamento" id="Departamento">\n                            </select>\n                        </div>\n                        <div class="mb-3">\n                            <label for="Municipio" class="form-label">Municipio</label>\n                            <select class="form-select" name="IdMunicipio" id="Municipio">\n                            </select>\n                        </div>\n                    </form>'),t.forEach((function(e){$("#sexo").append('<option value="'+e.Id+'">'+e.Nombre+"</option>")})),n.forEach((function(e){$("#Departamento").append('<option value="'+e.IdDepartamento+'">'+e.Nombre+"</option>")})),a.forEach((function(e){$("#Municipio").append('<option value="'+e.IdMunicipio+'">'+e.Nombre+"</option>")}))):"1"===o&&(e=1,$("#Estudiantechange").append("<form id='formEstudianteExistente'>\n\n                <div class='mb-3'>\n                        <label for='estudianteSelect' class='form-label'>Estudiante</label>\n                        <select class='form-select' name='Id_estudiante' id='estudianteSelect'>\n                        </select>\n                    </div>\n\n\n                </form>"),i.forEach((function(e){$("#estudianteSelect").append('<option value="'+e.Id+'">'+e.Nombres+" "+e.Apellidos+"</option>")})))})),$('input[name="tutorExistente"]').change((function(){const e=$(this).val();$("#tutorchange").empty(),"2"===e?(o=2,$("#tutorchange").append(" <form id='formTutorNuevo'>\n                <div class='mb-3'>\n                        <label for='nombresUsser' class='form-label'>Nombres</label>\n                        <input type='text' class='form-control' name='Nombres' id='nombresUsser'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='apellidosUsser' class='form-label'>Apellidos</label>\n                        <input type='text' class='form-control' name='Apellidos' id='apellidosUsser'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='Telefono' class='form-label'>Telefono</label>\n                        <input type='number' class='form-control' name='Telefono' id='Telefono'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='Cedula' class='form-label'>Cédula</label>\n                        <input type='text' class='form-control' name='Cedula' id='Cedula'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='Ocupacion' class='form-label'>Ocupación</label>\n                        <input type='text' class='form-control' name='Ocupacion' id='Ocupacion'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='Direccion' class='form-label'>Dirección</label>\n                        <textarea name='Direccion' id='Direccion' class='form-control'></textarea>\n                    </div>\n\n                    <div class='mb-3'>\n                        <label for='sexoTutor' class='form-label'>Sexo</label>\n                        <select class='form-select' name='Id_sexo' id='sexoTutor'>\n                        </select>\n                    </div>\n                </form>"),t.forEach((function(e){$("#sexoTutor").append('<option value="'+e.Id+'">'+e.Nombre+"</option>")}))):"1"===e&&(o=1,$("#tutorchange").append("<form id='formTutorExistente'>\n\n                <div class='mb-3'>\n                        <label for='Tutor' class='form-label'>Tutor</label>\n                        <select class='form-select' name='Id_Tutor' id='Tutor'>\n                        </select>\n                    </div>\n\n\n                </form>"),r.forEach((function(e){$("#Tutor").append('<option value="'+e.Id+'">'+e.Nombres+" "+e.Apellidos+"</option>")})))})),$("#GuardarMatricula").click((async()=>{let t=new FormData($("#FormDatosAcademicos")[0]);t=s(t),console.log(t," de prueba");const n={data_matricula:t},a=$("input[name='tutorExistente']:checked").val(),r=$("input[name='EstudianteExistente']:checked").val();if(!a)return void await Swal.fire({icon:"error",html:'<span style="font-size: 1.5rem; font-weight: 800;">Debe seleccionar una opción para el tutor</span>',toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"rgb(255, 184, 184)",showConfirmButton:!1});if(!r)return void await Swal.fire({icon:"error",html:'<span style="font-size: 1.5rem; font-weight: 800;">Debe seleccionar una opción para el tutor</span>',toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"rgb(255, 184, 184)",showConfirmButton:!1});if(1==e){let e=new FormData($("#formEstudianteExistente")[0]);e=s(e),n.EstudianteExistente=e,delete n.EstudianteNuevo,delete n.EstudianteInfo}else{let e=new FormData($("#formAddDatosPersonalesEstudiante")[0]),o=new FormData($("#formEstudiante")[0]);e=s(e),o=s(o),n.EstudianteNuevo=e,n.EstudianteInfo=o,delete n.EstudianteExistente}if(1==o){let e=new FormData($("#formTutorExistente")[0]);e=s(e),n.TutorExistente=e,delete n.TutorNuevo}else{let e=new FormData($("#formTutorNuevo")[0]);e=s(e),n.TutorNuevo=e,delete n.TutorExistente}const i=/^\d{8,11}$/,d=/^\d{13}[A-Za-z]$/,c=$('input[name="Telefono"]'),u=$('input[name="Cedula"]');let p=!0;c.each((async function(){if(!i.test($(this).val()))return p=!1,await Swal.fire({icon:"error",html:'<span style="font-size: 1.5rem; font-weight: 800;">El celular debe tener de 8 a 12 dígitos</span>',toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"rgb(255, 184, 184)",showConfirmButton:!1}),$(this).css("border","1px solid red"),!1;$(this).css("border","")})),u.each((async function(){if(!d.test($(this).val()))return p=!1,await Swal.fire({icon:"error",html:'<span style="font-size: 1.5rem; font-weight: 800;">La cédula está mal formateada</span>',toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"rgb(255, 184, 184)",showConfirmButton:!1}),$(this).css("border","1px solid red"),!1;$(this).css("border","")})),p&&(console.log(n),$.ajax({url:"/api/matricula/add",type:"POST",data:n,dataType:"json",success:async function(t){if(console.log(t,"de agregar"),t.exito)return await l(),1==o?$("#formTutorExistente")[0].reset():$("#formTutorNuevo")[0].reset(),1==e?$("#formEstudianteExistente")[0].reset():($("#formAddDatosPersonalesEstudiante")[0].reset(),$("#formEstudiante")[0].reset()),$("#agregarMatriculaModal").modal("hide"),void await Swal.fire({icon:"success",html:`<span style="font-size: 1.5rem; font-weight: 900;">${t.exito}</span>`,toast:!0,position:"bottom-end",iconColor:"green",timer:1500,padding:"2rem",background:"#B8FFB8",showConfirmButton:!1});t.error?await Swal.fire({icon:"error",html:`<span style="font-size: 1.5rem; font-weight: 900;">${t.error}</span>`,toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"#FFB8B8",showConfirmButton:!1}):t.alert&&await Swal.fire({icon:"warning",html:`<span style="font-size: 1.5rem; font-weight: 900;">${t.alert}</span>`,toast:!0,position:"bottom-end",iconColor:"yellow",timer:1500,padding:"2rem",background:"#F6FBC2",showConfirmButton:!1})},error:function(e,o,t){console.error(e.responseText)}}))})),$("#GuardarMatriculaEditada").click((async function(){let e=new FormData($("#formEstudianteEdit")[0]),o=new FormData($("#formTutorEdit")[0]),t=new FormData($("#FormDatosAcademicosEdit")[0]);e=s(e),o=s(o),t=s(t);const n={FormEstudiante:e,FormTutor:o,FormDatosAcademicos:t},a=$(".checkTelefono"),r=$(".checkCedula"),i=/^\d{8,11}$/,d=/^\d{13}[A-Za-z]$/;let c=!0;a.each((async function(){if(!i.test($(this).val()))return c=!1,await Swal.fire({icon:"error",html:'<span style="font-size: 1.5rem; font-weight: 800;">El celular debe tener de 8 a 12 dígitos</span>',toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"rgb(255, 184, 184)",showConfirmButton:!1}),$(this).css("border","1px solid red"),!1;$(this).css("border","")})),r.each((async function(){if(!d.test($(this).val()))return c=!1,await Swal.fire({icon:"error",html:'<span style="font-size: 1.5rem; font-weight: 800;">La cédula está mal formateada</span>',toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"rgb(255, 184, 184)",showConfirmButton:!1}),$(this).css("border","1px solid red"),!1;$(this).css("border","")})),c&&$.ajax({url:"/api/matricula/edit",method:"POST",dataType:"json",data:n,success:async function(e){if(console.log(e),e.exito)return $("#formEstudianteEdit")[0].reset(),$("#formTutorEdit")[0].reset(),$("#FormDatosAcademicosEdit")[0].reset(),await l(),$("#editarModal").modal("hide"),void await Swal.fire({icon:"success",html:`<span style="font-size: 1.5rem; font-weight: 900;">${e.exito}</span>`,toast:!0,position:"bottom-end",iconColor:"green",timer:1500,padding:"2rem",background:"#B8FFB8",showConfirmButton:!1})},error:function(e,o,t){console.error(e.responseText)}})}))})),$.ajax({url:"/api/matricula/all",dataType:"json",success:function(e){console.log(e);const o=$("#tablaMatriculas").DataTable({data:e,columns:[{data:"Id_anio_lectivo_anio"},{data:"Nombres_estudiante"},{data:"Nombres_tutor"},{data:"Id_turno_nombre"},{data:"Id_grado_nombre"},{data:null,render:function(e,o,t){return`\n                                <button type="button" class="btn btn-primary btn-editar" data-bs-toggle="modal" data-bs-target="#editarModal" data-id="${t.Id}">Editar</button>\n                                <button type="button" class="btn btn-danger btn-borrar" data-id="${t.Id}">Borrar</button>\n                                <button type="button" class="btn btn-success btn-reporte " data-id="${t.Id}"><i class="fa-solid fa-file-pdf"></i>Ver Matricula</button>\n                            `}}],language:{lengthMenu:"Mostrar _MENU_ registros por página",zeroRecords:"No se encontraron resultados",info:"Mostrando página _PAGE_ de _PAGES_",infoEmpty:"No hay registros disponibles",infoFiltered:"(filtrado de _MAX_ registros totales)",search:"Buscar:",loadingRecords:"Cargando...",processing:"Procesando...",emptyTable:"No hay datos disponibles en la tabla",aria:{sortAscending:": activar para ordenar la columna de manera ascendente",sortDescending:": activar para ordenar la columna de manera descendente"}}});$("#tablaMatriculas tbody").on("click",".btn-editar",(function(){const e=o.row($(this).parents("tr")).data();console.log(e),$("#editId_matricula").val(e.Id),$("#editId_estudiante").val(e.Id_estudiante),$("#editId_datos_personales_estudiante").val(e.Id_datos_personales_estudiante),$("#editId_tutor").val(e.Id_tutor),$("#editId_datos_personales_tutor").val(e.Id_datos_personales_tutor),$("#nombresEstudiante").val(e.Nombres_estudiante),$("#apellidosEstudiante").val(e.Apellidos_estudiante),$("#TelefonoEstudiante").val(e.Telefono_estudiante),$("#DireccionEstudiante").val(e.Direccion_estudiante),$("#sexoEstudiante").val(e.Id_sexo_estudiante),$("#Cod_estudianteEdit").val(e.Cod_estudiante),$("#DepartamentoEstudiante").val(e.IdDepartamento),$("#MunicipioEstudiante").val(e.IdMunicipio),$("#nombresTutor").val(e.Nombres_tutor),$("#apellidosTutor").val(e.Apellidos_tutor),$("#TelefonoTutor").val(e.Telefono_tutor),$("#CedulaTutor").val(e.Cedula),$("#OcupacionEdit").val(e.Ocupacion),$("#DireccionTutorEdit").val(e.Direccion_tutor),$("#sexoTutor").val(e.Id_sexo_tutor),$("#EdadEdit").val(e.Edad),$("#GradoEdit").val(e.id_grado),$("#TurnoEdit").val(e.id_turno),$("#AnioLectivoEdit").val(e.id_anio_lectivo)}))},error:function(e,o,t){console.error(e.responseText)}}),$("#tablaMatriculas").on("click",".btn-reporte",(function(){const e=$(this).data("id");Swal.fire({title:"Generando reporte",text:"Por favor espera...",icon:"info",showConfirmButton:!1,allowOutsideClick:!1}),$.ajax({url:"/api/reporte/matricula",type:"POST",data:{Id:e},xhrFields:{responseType:"blob"},success:function(e){Swal.close();const o=new Blob([e],{type:"application/pdf"}),t=window.URL.createObjectURL(o);window.open(t,"_blank"),setTimeout((()=>{window.URL.revokeObjectURL(t)}),100)},error:function(e,o,t){console.error("Error al obtener el PDF:",t),Swal.close(),Swal.fire({icon:"error",title:"Error",text:"Hubo un problema al generar el reporte. Por favor, intenta de nuevo más tarde."})}})})),$("#tablaMatriculas").on("click",".btn-borrar",(function(){const e=$(this).data("id");console.log("eliminar el registro ID:",e),$.ajax({url:"/api/matricula/del",type:"POST",data:{Id:e},dataType:"json",success:async function(e){if(e.exito)return await l(),void await Swal.fire({icon:"success",html:'<span style="font-size: 1.5rem; font-weight: 900;">Eliminado Correctamente</span>',toast:!0,position:"bottom-end",iconColor:"green",timer:1500,padding:"2rem",background:"#B8FFB8",showConfirmButton:!1})},error:function(e,o,t){console.error("Error:",t)}})})),$.ajax({url:"/api/sexo/all",dataType:"json",success:function(e){t=e,console.log(e,"del sexo"),t.forEach((function(e){$("#sexo").append('<option value="'+e.Id+'">'+e.Nombre+"</option>"),$("#sexoEstudiante").append('<option value="'+e.Id+'">'+e.Nombre+"</option>"),$("#sexoTutor").append('<option value="'+e.Id+'">'+e.Nombre+"</option>")}))},error:function(e){}}),$.ajax({url:"/api/departamentos/all",dataType:"json",success:function(e){console.log(e,"del departamento"),n=e,n.forEach((function(e){$("#Departamento").append('<option value="'+e.IdDepartamento+'">'+e.Nombre+"</option>"),$("#DepartamentoEstudiante").append('<option value="'+e.IdDepartamento+'">'+e.Nombre+"</option>")}))},error:function(e){}}),$.ajax({url:"/api/municipios/all",dataType:"json",success:function(e){console.log(e,"del municipios"),a=e,a.forEach((function(e){$("#Municipio").append('<option value="'+e.IdMunicipio+'">'+e.Nombre+"</option>"),$("#MunicipioEstudiante").append('<option value="'+e.IdMunicipio+'">'+e.Nombre+"</option>")}))},error:function(e){}}),$.ajax({url:"/api/tutores/all",dataType:"json",success:function(e){console.log(e,"de los tutores"),r=e},error:function(e,o,t){console.error(e.responseText)}}),$.ajax({url:"/api/estudiantes/all",dataType:"json",success:function(e){console.log(e,"del estudiante"),i=e},error:function(e,o,t){console.error(e.responseText)}}),$.ajax({url:"/api/grados/all",dataType:"json",success:function(e){console.log(e,"del listado del grado"),e.forEach((function(e){$("#Grado").append('<option value="'+e.Id+'">'+e.Nombre+"</option>"),$("#GradoEdit").append('<option value="'+e.Id+'">'+e.Nombre+"</option>")}))},error:function(e,o,t){console.error(e.responseText)}}),$.ajax({url:"/api/turnos/all",dataType:"json",success:function(e){console.log(e,"del listado del turno"),e.forEach((function(e){$("#Turno").append('<option value="'+e.Id+'">'+e.Nombre+"</option>"),$("#TurnoEdit").append('<option value="'+e.Id+'">'+e.Nombre+"</option>")}))},error:function(e,o,t){console.error(e.responseText)}}),$.ajax({url:"/api/anioslectivos/all",dataType:"json",success:function(e){console.log(e,"del listado del anio lectivo"),e.forEach((function(e){$("#AnioLectivo").append('<option value="'+e.Id+'">'+e.anio+"</option>"),$("#AnioLectivoEdit").append('<option value="'+e.Id+'">'+e.anio+"</option>")}))},error:function(e,o,t){console.error(e.responseText)}})}();//# sourceMappingURL=tablamatricula.js.map
