!function(){let e,o,n,a,t,r=[],s=[];function l(e){let o={};return e.forEach(((e,n)=>{o[n]=e})),o}$(document).ready((()=>{$('input[name="EstudianteExistente"]').change((function(){const o=$(this).val();$("#Estudiantechange").empty(),"2"===o?(e=2,$("#Estudiantechange").append('  <div>\n                        <h3 class="fs-2">Información y Datos Personales del Estudiante</h3>\n                    </div>\n\n\n\n                    <form id="formAddDatosPersonalesEstudiante">\n                        <div class="mb-3">\n                            <label for="nombresUsser" class="form-label">Nombres</label>\n                            <input type="text" class="form-control" name="Nombres" id="nombresUsser">\n                        </div>\n                        <div class="mb-3">\n                            <label for="apellidosUsser" class="form-label">Apellidos</label>\n                            <input type="text" class="form-control" name="Apellidos" id="apellidosUsser">\n                        </div>\n                        <div class="mb-3">\n                            <label for="Telefono" class="form-label">Telefono</label>\n                            <input type="number" class="form-control" name="Telefono" id="Telefono">\n                        </div> \n                        <div class="mb-3">\n                            <label for="Direccion" class="form-label">Dirección</label>\n                            <textarea name="Direccion" id="Direccion" class="form-control"></textarea>\n                        </div>\n\n                        <div class="mb-3">\n                            <label for="sexo" class="form-label">Sexo</label>\n                            <select class="form-select" name="Id_sexo" id="sexo">\n                            </select>\n                        </div>\n\n\n                    </form>\n\n                    <div class="mt-5">\n                        <h3 class="fs-2">Código del Estudiante y Ubicación </h3>\n                    </div>\n\n                    <form id="formEstudiante">\n                        <div class="mb-3">\n                            <label for="Cod_estudiante" class="form-label">Código de Estudiante</label>\n                            <input name="Cod_estudiante" id="Cod_estudiante" class="form-control">\n                        </div>\n                        <div class="mb-3">\n                            <label for="Departamento" class="form-label">Departamento</label>\n                            <select class="form-select" name="IdDepartamento" id="Departamento">\n                            </select>\n                        </div>\n                        <div class="mb-3">\n                            <label for="Municipio" class="form-label">Municipio</label>\n                            <select class="form-select" name="IdMunicipio" id="Municipio">\n                            </select>\n                        </div>\n                    </form>'),n.forEach((function(e){$("#sexo").append('<option value="'+e.Id+'">'+e.Nombre+"</option>")})),a.forEach((function(e){$("#Departamento").append('<option value="'+e.IdDepartamento+'">'+e.Nombre+"</option>")})),t.forEach((function(e){$("#Municipio").append('<option value="'+e.IdMunicipio+'">'+e.Nombre+"</option>")}))):"1"===o&&(e=1,$("#Estudiantechange").append("<form id='formEstudianteExistente'>\n\n                <div class='mb-3'>\n                        <label for='estudianteSelect' class='form-label'>Estudiante</label>\n                        <select class='form-select' name='Id_estudiante' id='estudianteSelect'>\n                        </select>\n                    </div>\n\n\n                </form>"),s.forEach((function(e){$("#estudianteSelect").append('<option value="'+e.Id+'">'+e.Nombres+" "+e.Apellidos+"</option>")})))})),$('input[name="tutorExistente"]').change((function(){const e=$(this).val();$("#tutorchange").empty(),"2"===e?(o=2,$("#tutorchange").append(" <form id='formTutorNuevo'>\n                <div class='mb-3'>\n                        <label for='nombresUsser' class='form-label'>Nombres</label>\n                        <input type='text' class='form-control' name='Nombres' id='nombresUsser'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='apellidosUsser' class='form-label'>Apellidos</label>\n                        <input type='text' class='form-control' name='Apellidos' id='apellidosUsser'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='Telefono' class='form-label'>Telefono</label>\n                        <input type='number' class='form-control' name='Telefono' id='Telefono'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='Cedula' class='form-label'>Cédula</label>\n                        <input type='text' class='form-control' name='Cedula' id='Cedula'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='Ocupacion' class='form-label'>Ocupación</label>\n                        <input type='text' class='form-control' name='Ocupacion' id='Ocupacion'>\n                    </div>\n                    <div class='mb-3'>\n                        <label for='Direccion' class='form-label'>Dirección</label>\n                        <textarea name='Direccion' id='Direccion' class='form-control'></textarea>\n                    </div>\n\n                    <div class='mb-3'>\n                        <label for='sexoTutor' class='form-label'>Sexo</label>\n                        <select class='form-select' name='Id_sexo' id='sexoTutor'>\n                        </select>\n                    </div>\n                </form>"),n.forEach((function(e){$("#sexoTutor").append('<option value="'+e.Id+'">'+e.Nombre+"</option>")}))):"1"===e&&(o=1,$("#tutorchange").append("<form id='formTutorExistente'>\n\n                <div class='mb-3'>\n                        <label for='Tutor' class='form-label'>Tutor</label>\n                        <select class='form-select' name='Id_Tutor' id='Tutor'>\n                        </select>\n                    </div>\n\n\n                </form>"),r.forEach((function(e){$("#Tutor").append('<option value="'+e.Id+'">'+e.Nombres+" "+e.Apellidos+"</option>")})))})),$("#GuardarMatricula").click((async()=>{let n=new FormData($("#FormDatosAcademicos")[0]);n=l(n),console.log(n," de prueba");const a={data_matricula:n},t=$("input[name='tutorExistente']:checked").val(),r=$("input[name='EstudianteExistente']:checked").val();if(t)if(r){if(1==e){let e=new FormData($("#formEstudianteExistente")[0]);e=l(e),a.EstudianteExistente=e,delete a.EstudianteNuevo,delete a.EstudianteInfo}else{let e=new FormData($("#formAddDatosPersonalesEstudiante")[0]),o=new FormData($("#formEstudiante")[0]);e=l(e),o=l(o),a.EstudianteNuevo=e,a.EstudianteInfo=o,delete a.EstudianteExistente}if(1==o){let e=new FormData($("#formTutorExistente")[0]);e=l(e),a.TutorExistente=e,delete a.TutorNuevo}else{let e=new FormData($("#formTutorNuevo")[0]);e=l(e),a.TutorNuevo=e,delete a.TutorExistente}console.log(a),$.ajax({url:"/api/matricula/add",type:"POST",data:a,dataType:"json",success:async function(e){if(console.log(e,"de agregar"),e.exito)return await async function(){$.ajax({url:"/api/matricula/all",dataType:"json",success:function(e){console.log(e);$("#tablaMatriculas").DataTable({destroy:!0,data:e,columns:[{data:"Id_anio_lectivo_anio"},{data:"Nombres_estudiante"},{data:"Nombres_tutor"},{data:"Id_turno_nombre"},{data:"Id_grado_nombre"},{data:null,render:function(e,o,n){return'<button type="button" class="btn btn-primary btn-editar" data-bs-toggle="modal" data-bs-target="#editarModal">Editar</button> <button type="button" class="btn btn-danger">Borrar</button>'}}],language:{lengthMenu:"Mostrar _MENU_ registros por página",zeroRecords:"No se encontraron resultados",info:"Mostrando página _PAGE_ de _PAGES_",infoEmpty:"No hay registros disponibles",infoFiltered:"(filtrado de _MAX_ registros totales)",search:"Buscar:",loadingRecords:"Cargando...",processing:"Procesando...",emptyTable:"No hay datos disponibles en la tabla",aria:{sortAscending:": activar para ordenar la columna de manera ascendente",sortDescending:": activar para ordenar la columna de manera descendente"}}})},error:function(e,o,n){console.error(e.responseText)}})}(),$("#agregarMatriculaModal").modal("hide"),void await Swal.fire({icon:"success",html:`<span style="font-size: 1.5rem; font-weight: 900;">${e.exito}</span>`,toast:!0,position:"bottom-end",iconColor:"green",timer:1500,padding:"2rem",background:"#B8FFB8",showConfirmButton:!1});e.error?await Swal.fire({icon:"error",html:`<span style="font-size: 1.5rem; font-weight: 900;">${e.error}</span>`,toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"#FFB8B8",showConfirmButton:!1}):e.alert&&await Swal.fire({icon:"warning",html:`<span style="font-size: 1.5rem; font-weight: 900;">${e.alert}</span>`,toast:!0,position:"bottom-end",iconColor:"yellow",timer:1500,padding:"2rem",background:"#F6FBC2",showConfirmButton:!1})},error:function(e,o,n){console.error(e.responseText)}})}else await Swal.fire({icon:"error",html:'<span style="font-size: 1.5rem; font-weight: 800;">Debe seleccionar una opción para el tutor</span>',toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"rgb(255, 184, 184)",showConfirmButton:!1});else await Swal.fire({icon:"error",html:'<span style="font-size: 1.5rem; font-weight: 800;">Debe seleccionar una opción para el tutor</span>',toast:!0,position:"bottom-end",iconColor:"red",timer:1500,padding:"2rem",background:"rgb(255, 184, 184)",showConfirmButton:!1})}))})),$.ajax({url:"/api/matricula/all",dataType:"json",success:function(e){console.log(e);$("#tablaMatriculas").DataTable({data:e,columns:[{data:"Id_anio_lectivo_anio"},{data:"Nombres_estudiante"},{data:"Nombres_tutor"},{data:"Id_turno_nombre"},{data:"Id_grado_nombre"},{data:null,render:function(e,o,n){return`\n                                <button type="button" class="btn btn-primary btn-editar" data-bs-toggle="modal" data-bs-target="#editarModal" data-id="${n.id}">Editar</button>\n                                <button type="button" class="btn btn-danger btn-borrar" data-id="${n.Id}">Borrar</button>\n                                <button type="button" class="btn btn-success btn-reporte " data-id="${n.Id}"><i class="fa-solid fa-file-pdf"></i>Ver Matricula</button>\n                            `}}],language:{lengthMenu:"Mostrar _MENU_ registros por página",zeroRecords:"No se encontraron resultados",info:"Mostrando página _PAGE_ de _PAGES_",infoEmpty:"No hay registros disponibles",infoFiltered:"(filtrado de _MAX_ registros totales)",search:"Buscar:",loadingRecords:"Cargando...",processing:"Procesando...",emptyTable:"No hay datos disponibles en la tabla",aria:{sortAscending:": activar para ordenar la columna de manera ascendente",sortDescending:": activar para ordenar la columna de manera descendente"}}})},error:function(e,o,n){console.error(e.responseText)}}),$("#tablaMatriculas").on("click",".btn-reporte",(function(){const e=$(this).data("id");console.log("Generar reporte para matricula con ID:",e),$.ajax({url:"/api/reporte/matricula",type:"POST",data:{Id:e},xhrFields:{responseType:"blob"},success:function(e){const o=new Blob([e],{type:"application/pdf"}),n=window.URL.createObjectURL(o);window.open(n,"_blank"),setTimeout((()=>{window.URL.revokeObjectURL(n)}),100)},error:function(e,o,n){console.error("Error al obtener el PDF:",n)}})})),$.ajax({url:"/api/sexo/all",dataType:"json",success:function(e){n=e,console.log(e,"del sexo")},error:function(e){}}),$.ajax({url:"/api/departamentos/all",dataType:"json",success:function(e){console.log(e,"del departamento"),a=e},error:function(e){}}),$.ajax({url:"/api/municipios/all",dataType:"json",success:function(e){console.log(e,"del municipios"),t=e},error:function(e){}}),$.ajax({url:"/api/tutores/all",dataType:"json",success:function(e){console.log(e,"de los tutores"),r=e},error:function(e,o,n){console.error(e.responseText)}}),$.ajax({url:"/api/estudiantes/all",dataType:"json",success:function(e){console.log(e,"del estudiante"),s=e},error:function(e,o,n){console.error(e.responseText)}}),$.ajax({url:"/api/grados/all",dataType:"json",success:function(e){console.log(e,"del listado del grado"),e.forEach((function(e){$("#Grado").append('<option value="'+e.Id+'">'+e.Nombre+"</option>")}))},error:function(e,o,n){console.error(e.responseText)}}),$.ajax({url:"/api/turnos/all",dataType:"json",success:function(e){console.log(e,"del listado del turno"),e.forEach((function(e){$("#Turno").append('<option value="'+e.Id+'">'+e.Nombre+"</option>")}))},error:function(e,o,n){console.error(e.responseText)}}),$.ajax({url:"/api/anioslectivos/all",dataType:"json",success:function(e){console.log(e,"del listado del anio lectivo"),e.forEach((function(e){$("#AnioLectivo").append('<option value="'+e.Id+'">'+e.anio+"</option>")}))},error:function(e,o,n){console.error(e.responseText)}})}();//# sourceMappingURL=tablamatricula.js.map
